# PEMS v2 Configuration Template
# Copy this file to .env and fill in your values
# All values are validated for safety and logical consistency

# InfluxDB Configuration (required)
INFLUXDB_URL=http://localhost:8086    # InfluxDB server URL
INFLUXDB_TOKEN=your_influxdb_token_here  # Required: authentication token
INFLUXDB_ORG=smart_home               # Organization name
# Data bucket configuration
INFLUXDB_BUCKET_HISTORICAL=loxone     # Historical sensor data
INFLUXDB_BUCKET_LOXONE=loxone         # Live Loxone system data
INFLUXDB_BUCKET_WEATHER=weather_forecast  # Weather forecast data
INFLUXDB_BUCKET_SOLAR=loxone          # Solar/PV production data
INFLUXDB_BUCKET_PREDICTIONS=predictions   # ML model predictions
INFLUXDB_BUCKET_OPTIMIZATION=optimization # Optimization results

# MQTT Configuration (validated)
MQTT_BROKER=localhost    # Cannot be empty
MQTT_PORT=1883          # Range: 1-65535
MQTT_USERNAME=          # Optional authentication
MQTT_PASSWORD=          # Optional authentication
MQTT_CLIENT_ID=pems_v2  # Cannot be empty

# PV Prediction Settings (validated ranges)
PV_MODEL_PATH=models/pv_predictor.pkl  # Path to trained model
PV_UPDATE_INTERVAL=3600      # Min: 300 seconds (5 minutes)
PV_HORIZON_HOURS=48          # Range: 1-168 hours (1 week max)
PV_CONFIDENCE_LEVELS=[0.1,0.5,0.9]  # Must be sorted probabilities (0.0-1.0)

# Thermal Settings (validated temperature ranges)
THERMAL_DEFAULT_SETPOINT_DAY=21.0    # Range: 15-30°C
THERMAL_DEFAULT_SETPOINT_NIGHT=19.0  # Range: 10-25°C, must be ≤ day setpoint
THERMAL_COMFORT_BAND=0.5             # Range: 0.1-5.0°C

# Optimization Settings (validated constraints)
OPT_HORIZON_HOURS=48        # Optimization planning horizon
OPT_CONTROL_HOURS=24        # Must be ≤ horizon_hours
OPT_TIME_STEP_MINUTES=60    # Range: 5-120 minutes
OPT_SOLVER=APOPT           # Mathematical solver (APOPT, IPOPT, etc.)
OPT_MAX_SOLVE_TIME=30      # Maximum solver time in seconds

# Multi-objective optimization weights (all must be non-negative, at least one positive)
OPT_COST_WEIGHT=1.0                  # Energy cost minimization weight
OPT_SELF_CONSUMPTION_WEIGHT=0.3      # PV self-consumption maximization weight
OPT_PEAK_SHAVING_WEIGHT=0.1          # Peak demand reduction weight
OPT_COMFORT_WEIGHT=0.5               # Thermal comfort maintenance weight

# Battery Settings (validated for safety and realism)
BATTERY_CAPACITY_KWH=10.0    # Must be positive
BATTERY_MAX_POWER_KW=5.0     # Must be positive, C-rate (power/capacity) ≤ 5.0
BATTERY_EFFICIENCY=0.95      # Range: 0.5-1.0 (50%-100%)
BATTERY_MIN_SOC=0.1          # Range: 0.0-1.0, must be < max_soc
BATTERY_MAX_SOC=0.9          # Range: 0.0-1.0, must be > min_soc

# EV Settings (validated parameters)
EV_MAX_POWER_KW=11.0         # Must be positive (typical home charger: 11kW)
EV_BATTERY_CAPACITY_KWH=60.0 # Must be positive (typical EV: 40-100kWh)
EV_DEFAULT_TARGET_SOC=0.8    # Range: 0.0-1.0 (80% is common target)
EV_DEPARTURE_TIME=07:00      # Format: HH:MM (24-hour format)

# PEMS System Settings (validated timing constraints)
PEMS_SIMULATION_MODE=false       # Enable simulation mode (no hardware control)
PEMS_ADVISORY_MODE=false         # Generate recommendations only (no automatic control)
PEMS_OPTIMIZATION_INTERVAL=3600  # How often to run optimization (seconds, must be positive)
PEMS_CONTROL_INTERVAL=300        # How often to update controls (seconds, must be ≤ optimization_interval, min: 60s)

# Example Invalid Configurations (will fail validation):
# BATTERY_MIN_SOC=0.9, BATTERY_MAX_SOC=0.8  # Error: min_soc must be < max_soc
# OPT_CONTROL_HOURS=50, OPT_HORIZON_HOURS=24  # Error: control_hours cannot exceed horizon_hours
# THERMAL_DEFAULT_SETPOINT_NIGHT=25.0, THERMAL_DEFAULT_SETPOINT_DAY=20.0  # Error: night > day
# PV_UPDATE_INTERVAL=60  # Error: minimum is 300 seconds
# BATTERY_EFFICIENCY=1.5  # Error: efficiency cannot exceed 100%
# EV_DEPARTURE_TIME=25:00  # Error: invalid time format